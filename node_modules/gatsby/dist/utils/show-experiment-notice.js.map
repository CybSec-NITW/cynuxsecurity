{"version":3,"sources":["../../src/utils/show-experiment-notice.ts"],"names":["ONE_DAY","showExperimentNoticeAfterTimeout","experimentIdentifier","noticeText","showNoticeAfterMs","minimumIntervalBetweenNoticesMs","configStoreKey","lastTimeWeShowedNotice","get","Date","now","undefined","noticeTimeout","setTimeout","reporter","info","set","clearNoticeTimeout","clearTimeout"],"mappings":";;;;;;;AAAA;;AACA;;AAQA,MAAMA,OAAO,GAAG,KAAK,EAAL,GAAU,EAAV,GAAe,IAA/B;;AAEO,SAASC,gCAAT,CACLC,oBADK,EAELC,UAFK,EAGLC,iBAHK,EAILC,+BAAuC,GAAGL,OAJrC,EAKsC;AAC3C,QAAMM,cAAc,GAAI,wBAAuBJ,oBAAqB,EAApE;AAEA,QAAMK,sBAAsB,GAAG,uCAAiBC,GAAjB,CAAqBF,cAArB,CAA/B;;AAEA,MAAIC,sBAAJ,EAA4B;AAC1B,QAAIE,IAAI,CAACC,GAAL,KAAaH,sBAAb,GAAsCF,+BAA1C,EAA2E;AACzE,aAAOM,SAAP;AACD;AACF;;AAED,QAAMC,aAAa,GAAGC,UAAU,CAAC,MAAM;AACrCC,sBAASC,IAAT,CAAe,OAAMZ,UAAW,MAAhC;;AAEA,2CAAiBa,GAAjB,CAAqBV,cAArB,EAAqCG,IAAI,CAACC,GAAL,EAArC;AACD,GAJ+B,EAI7BN,iBAJ6B,CAAhC;AAMA,SAAO,SAASa,kBAAT,GAAoC;AACzCC,IAAAA,YAAY,CAACN,aAAD,CAAZ;AACD,GAFD;AAGD","sourcesContent":["import { getConfigStore } from \"gatsby-core-utils\"\nimport reporter from \"gatsby-cli/lib/reporter\"\n\ntype CancelExperimentNoticeCallback = () => void\n\nexport type CancelExperimentNoticeCallbackOrUndefined =\n  | CancelExperimentNoticeCallback\n  | undefined\n\nconst ONE_DAY = 24 * 60 * 60 * 1000\n\nexport function showExperimentNoticeAfterTimeout(\n  experimentIdentifier: string,\n  noticeText: string,\n  showNoticeAfterMs: number,\n  minimumIntervalBetweenNoticesMs: number = ONE_DAY\n): CancelExperimentNoticeCallbackOrUndefined {\n  const configStoreKey = `lastExperimentNotice.${experimentIdentifier}`\n\n  const lastTimeWeShowedNotice = getConfigStore().get(configStoreKey)\n\n  if (lastTimeWeShowedNotice) {\n    if (Date.now() - lastTimeWeShowedNotice < minimumIntervalBetweenNoticesMs) {\n      return undefined\n    }\n  }\n\n  const noticeTimeout = setTimeout(() => {\n    reporter.info(`\\n\\n${noticeText}\\n\\n`)\n\n    getConfigStore().set(configStoreKey, Date.now())\n  }, showNoticeAfterMs)\n\n  return function clearNoticeTimeout(): void {\n    clearTimeout(noticeTimeout)\n  }\n}\n"],"file":"show-experiment-notice.js"}